{{define "title"}}View Post - ThreadHub{{end}}
{{define "content"}}
<div class="post-container">
    <div class="post">
        <div class="post-header">
            <div class="post-info">
                <div class="post-meta">
                    <span class="post-author">{{.Post.Author}}</span>
                    <span class="timestamp" data-timestamp="{{.Post.Timestamp.Format "2006-01-02T15:04:05Z07:00"}}"></span>
                    <span class="post-category">{{.Post.Category}}</span>
                </div>
                <h3 class="post-title">{{.Post.Title}}</h3>
            </div>
        </div>
        <div class="post-content">{{.Post.Content}}</div>
        {{if .Post.ImageUrl.Valid}}
        <div class="post-image">
            <img src="{{.Post.ImageUrl.String}}" alt="Post image" loading="lazy">
        </div>
        {{end}}
        <div class="post-footer">
            <div class="vote-buttons">
                <button class="vote-button" data-vote="up" data-post-id="{{.Post.ID}}">
                    <i class="fas fa-thumbs-up"></i>
                </button>
                <span class="vote-count">{{.Post.Likes}}</span>
                <button class="vote-button" data-vote="down" data-post-id="{{.Post.ID}}">
                    <i class="fas fa-thumbs-down"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Comments section -->
    <div class="comments-section">
        <h3>Comments</h3>
        {{if .IsAuthenticated}}
        <div class="comment-form">
            <textarea placeholder="Write a comment..." id="commentText"></textarea>
            <button data-post-id="{{.Post.ID}}" onclick="submitComment(this)">Submit</button>
        </div>
        {{else}}
        <p>Please <a href="/login_Page">login</a> to comment</p>
        {{end}}

        <div class="comments-container">
            {{template "comments" dict "Comments" .Comments "IsAuthenticated" .IsAuthenticated "Post" .Post}}
        </div>
    </div>
</div>

<div id="toast" class="toast">
    <div id="toastMessage" class="toast-message"></div>
</div>
{{end}}

{{define "scripts"}}
<script src="../static/js/viewPost.js"></script>
<script src="../static/js/theme.js"></script>
{{end}}

{{define "comments"}}
    {{range $comment := .Comments}}
    <div class="comment" data-comment-id="{{$comment.ID}}">
        <div class="comment-header">
            <span class="comment-author">{{$comment.Author}}</span>
            <span class="timestamp" data-timestamp="{{$comment.Timestamp.Format "2006-01-02T15:04:05Z07:00"}}"></span>
        </div>
        <div class="comment-content">{{$comment.Content}}</div>
    </div>
    {{end}}
{{end}}